{% extends 'base.html' %}

{% block title %}Ficha Clínica - {{ patient.full_name }} - MakiMotion{% endblock %}

{% block content %}
<div class="clinical-detail-container">
    <div class="ficha-header">
        <div class="ficha-info">
            <h2>Ficha Clínica - {{ patient.full_name }}</h2>
            <div class="ficha-meta">
                <span class="ficha-date">Creada: {{ ficha.created_at|date:"d/m/Y H:i" }}</span>
                {% if ficha.updated_at != ficha.created_at %}
                    <span class="ficha-updated">Actualizada: {{ ficha.updated_at|date:"d/m/Y H:i" }}</span>
                {% endif %}
            </div>
        </div>
        <div class="ficha-actions">
            <a href="{% url 'ficha_clinica_update' patient.pk ficha.pk %}" class="btn btn-primary">Editar Ficha</a>
            <a href="{% url 'ficha_clinica_delete' patient.pk ficha.pk %}" class="btn btn-danger">Eliminar</a>
            <a href="{% url 'patient_detail' patient.pk %}" class="btn btn-secondary">Volver al Paciente</a>
            <a href="{% url 'ficha_clinica_list' patient.pk %}" class="btn btn-info">Ver Todas las Fichas</a>
        </div>
    </div>

    <div class="ficha-content-layout">
        <div class="main-content-column">
            
            <!-- MOTIVO DE CONSULTA -->
            {% if ficha.consultation_reason %}
            <div class="clinical-section">
                <h3 class="section-title">📋 Motivo de Consulta</h3>
                <div class="section-content">
                    <div class="detail-item full-width">
                        <span>{{ ficha.consultation_reason|linebreaks }}</span>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- APRENDIZAJES GENERALES -->
            <div class="clinical-section">
                <h3 class="section-title">🧠 Aprendizajes Generales</h3>
                <div class="section-content">
                    <div class="detail-grid">
                        {% if ficha.aprendizaje_pujo_caca %}<div class="detail-item"><span>✔️ Pujo caca</span></div>{% endif %}
                        {% if ficha.aprendizaje_banquito %}<div class="detail-item"><span>✔️ Uso de banquito</span></div>{% endif %}
                        {% if ficha.aprendizaje_transverso %}<div class="detail-item"><span>✔️ Activación transverso abdominal</span></div>{% endif %}
                        {% if ficha.aprendizaje_respiracion_pelvico %}<div class="detail-item"><span>✔️ Respiración + contracción piso pélvico</span></div>{% endif %}
                        {% if ficha.aprendizaje_contraccion_pelvico %}<div class="detail-item"><span>✔️ Contracción piso pélvico</span></div>{% endif %}
                        {% if ficha.aprendizaje_preapretar %}<div class="detail-item"><span>✔️ Preapretar</span></div>{% endif %}
                    </div>
                    {% if ficha.aprendizaje_otros %}
                        <div class="detail-item full-width">
                            <strong>Otros aprendizajes generales:</strong>
                            <span>{{ ficha.aprendizaje_otros|linebreaks }}</span>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- APRENDIZAJES EMBARAZO -->
            {% if ficha.aprendizaje_emb_oms or ficha.aprendizaje_emb_anatomia or ficha.aprendizaje_emb_movimientos or ficha.aprendizaje_emb_posicion_trabajo or ficha.aprendizaje_emb_posicion_expulsion or ficha.aprendizaje_emb_intervencion or ficha.aprendizaje_emb_masaje_perineal or ficha.aprendizaje_emb_respiraciones or ficha.aprendizaje_emb_pujo or ficha.aprendizaje_emb_tecnicas_dolor or ficha.aprendizaje_emb_otros %}
            <div class="clinical-section">
                <h3 class="section-title">🤰 Aprendizajes Embarazo</h3>
                <div class="section-content">
                    <div class="detail-grid">
                        {% if ficha.aprendizaje_emb_oms %}<div class="detail-item"><span>✔️ OMS</span></div>{% endif %}
                        {% if ficha.aprendizaje_emb_anatomia %}<div class="detail-item"><span>✔️ Anatomía</span></div>{% endif %}
                        {% if ficha.aprendizaje_emb_movimientos %}<div class="detail-item"><span>✔️ Movimientos cardinales</span></div>{% endif %}
                        {% if ficha.aprendizaje_emb_posicion_trabajo %}<div class="detail-item"><span>✔️ Posición trabajo de parto</span></div>{% endif %}
                        {% if ficha.aprendizaje_emb_posicion_expulsion %}<div class="detail-item"><span>✔️ Posición expulsión</span></div>{% endif %}
                        {% if ficha.aprendizaje_emb_intervencion %}<div class="detail-item"><span>✔️ Intervención obstétrica</span></div>{% endif %}
                        {% if ficha.aprendizaje_emb_masaje_perineal %}<div class="detail-item"><span>✔️ Masaje perineal</span></div>{% endif %}
                        {% if ficha.aprendizaje_emb_respiraciones %}<div class="detail-item"><span>✔️ Respiraciones</span></div>{% endif %}
                        {% if ficha.aprendizaje_emb_pujo %}<div class="detail-item"><span>✔️ Pujo embarazo</span></div>{% endif %}
                        {% if ficha.aprendizaje_emb_tecnicas_dolor %}<div class="detail-item"><span>✔️ Técnicas de dolor</span></div>{% endif %}
                    </div>
                    {% if ficha.aprendizaje_emb_otros %}
                        <div class="detail-item full-width">
                            <strong>Otros aprendizajes embarazo:</strong>
                            <span>{{ ficha.aprendizaje_emb_otros|linebreaks }}</span>
                        </div>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <!-- HÁBITOS DE VIDA -->
            <div class="clinical-section">
                <h3 class="section-title">🏃 Hábitos de Vida</h3>
                <div class="section-content">
                    <div class="detail-grid">
                        {% if ficha.smoking %}
                            <div class="detail-item">
                                <strong>Fuma:</strong>
                                <span>{{ ficha.get_smoking_display|default:"No especificado" }}</span>
                            </div>
                        {% endif %}
                        {% if ficha.alcohol %}
                            <div class="detail-item">
                                <strong>Alcohol:</strong>
                                <span>{{ ficha.get_alcohol_display|default:"No especificado" }}</span>
                            </div>
                        {% endif %}
                    </div>
                    
                    {% if ficha.physical_activity %}
                        <div class="detail-item full-width">
                            <strong>Actividad Física:</strong>
                            <span>{{ ficha.physical_activity|linebreaks }}</span>
                        </div>
                    {% endif %}

                    {% if ficha.diet %}
                        <div class="detail-item full-width">
                            <strong>Dieta:</strong>
                            <span>{{ ficha.diet|linebreaks }}</span>
                        </div>
                    {% endif %}

                    {% if ficha.daily_liquid_consumption %}
                        <div class="detail-item full-width">
                            <strong>Consumo Líquido Diario:</strong>
                            <span>{{ ficha.daily_liquid_consumption }}</span>
                        </div>
                    {% endif %}

                    {% if ficha.lifestyle_other %}
                        <div class="detail-item full-width">
                            <strong>Otros:</strong>
                            <span>{{ ficha.lifestyle_other|linebreaks }}</span>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- More sections would continue here... -->

        </div>
    </div>
</div>
{% endblock %}
